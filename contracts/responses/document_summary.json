{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "document_summary.json",
  "title": "DocumentSummary Response",
  "description": "Lightweight summary of the Rhino document",
  "type": "object",
  "properties": {
    "meta_data": {
      "type": "object",
      "properties": {
        "name": { "type": ["string", "null"] },
        "date_created": { "type": "string" },
        "date_modified": { "type": "string" },
        "tolerance": { "type": "number" },
        "angle_tolerance": { "type": "number" },
        "path": { "type": ["string", "null"] },
        "units": { "type": "string" }
      },
      "required": ["name", "tolerance", "units"]
    },
    "object_count": {
      "type": "integer",
      "description": "Total number of objects in document"
    },
    "objects_by_type": {
      "type": "object",
      "description": "Count of objects grouped by type (e.g., {\"CURVE\": 50, \"BREP\": 30})",
      "additionalProperties": { "type": "integer" }
    },
    "objects_by_layer": {
      "type": "object",
      "description": "Count of objects grouped by layer name",
      "additionalProperties": { "type": "integer" }
    },
    "model_bounding_box": {
      "oneOf": [
        { "$ref": "../common/definitions.json#/$defs/boundingBox" },
        { "type": "null" }
      ],
      "description": "Bounding box encompassing all objects"
    },
    "layer_count": {
      "type": "integer",
      "description": "Total number of layers"
    },
    "layer_hierarchy": {
      "type": "array",
      "description": "Hierarchical layer tree with parent-child relationships",
      "items": { "$ref": "#/$defs/layerNode" }
    }
  },
  "required": ["meta_data", "object_count", "objects_by_type", "objects_by_layer", "layer_count", "layer_hierarchy"],

  "$defs": {
    "layerNode": {
      "type": "object",
      "properties": {
        "id": { "$ref": "../common/definitions.json#/$defs/guid" },
        "name": { "type": "string" },
        "full_path": { "type": "string" },
        "color": { "$ref": "../common/definitions.json#/$defs/colorObject" },
        "visible": { "type": "boolean" },
        "locked": { "type": "boolean" },
        "object_count": { "type": "integer" },
        "parent_id": {
          "oneOf": [
            { "$ref": "../common/definitions.json#/$defs/guid" },
            { "type": "null" }
          ]
        },
        "children": {
          "type": "array",
          "items": { "$ref": "#/$defs/layerNode" }
        }
      },
      "required": ["id", "name", "full_path", "object_count", "children"]
    }
  }
}
